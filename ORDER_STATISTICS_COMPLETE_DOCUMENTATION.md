# üìä Order Statistics APIs - Complete Documentation for Frontend

## üéØ T·ªïng quan
H·ªá th·ªëng Order Statistics APIs cung c·∫•p **2-tier architecture** ƒë·ªÉ l·∫•y th·ªëng k√™ ƒë∆°n h√†ng:

1. **TIER 1 - Summary API**: D·ªØ li·ªáu t·ªïng quan cho charts/graphs
2. **TIER 2 - Details API**: Chi ti·∫øt ƒë∆°n h√†ng khi click v√†o ƒëi·ªÉm c·ª• th·ªÉ

---

## üî• TIER 1: Order Statistics Summary API

### **Endpoint**
```
GET /api/orders/statistics/summary
```

### **Parameters**

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `period` | String | ‚ùå | "day" | Lo·∫°i th·ªùi gian: "day", "week", "month", "quarter", "year" |
| `fromDate` | Long | ‚ùå | null | Timestamp b·∫Øt ƒë·∫ßu (milliseconds) - B·∫Øt bu·ªôc khi d√πng custom range |
| `toDate` | Long | ‚ùå | null | Timestamp k·∫øt th√∫c (milliseconds) - B·∫Øt bu·ªôc khi d√πng custom range |

### **üéÆ C√°c tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng**

#### **1. Daily Summary (7 ng√†y g·∫ßn nh·∫•t)**
```javascript
// Request
GET /api/orders/statistics/summary?period=day

// Response Structure
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [
    // 7 records, m·ªói record = 1 ng√†y
    {
      "date": "2025-08-25",
      "totalOrders": 45,
      "completedOrders": 38,
      "canceledOrders": 5,
      "refundedOrders": 2,
      "netRevenue": 2450000.00,
      "aov": 54444.44,
      "period": "daily",
      "dateRange": "2025-08-25",
      "startDate": "2025-08-25",
      "endDate": "2025-08-25"
    },
    {
      "date": "2025-08-24",
      "totalOrders": 52,
      "completedOrders": 41,
      "canceledOrders": 8,
      "refundedOrders": 3,
      "netRevenue": 2890000.00,
      "aov": 55576.92,
      "period": "daily",
      "dateRange": "2025-08-24",
      "startDate": "2025-08-24",
      "endDate": "2025-08-24"
    }
    // ... 5 records n·ªØa
  ]
}
```

#### **2. Weekly Summary**
```javascript
// Request  
GET /api/orders/statistics/summary?period=week

// Response Structure
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [
    // Nhi·ªÅu records, m·ªói record = 1 tu·∫ßn
    {
      "date": "2025-08-19",           // Monday c·ªßa tu·∫ßn
      "totalOrders": 320,
      "completedOrders": 285,
      "canceledOrders": 25,
      "refundedOrders": 10,
      "netRevenue": 18500000.00,
      "aov": 57812.50,
      "period": "weekly",
      "dateRange": "2025-08-19 to 2025-08-25",
      "weekNumber": 34,
      "year": 2025,
      "startDate": "2025-08-19",
      "endDate": "2025-08-25"
    },
    {
      "date": "2025-08-12",
      "totalOrders": 295,
      "completedOrders": 250,
      "canceledOrders": 30,
      "refundedOrders": 15,
      "netRevenue": 16200000.00,
      "aov": 54915.25,
      "period": "weekly",
      "dateRange": "2025-08-12 to 2025-08-18",
      "weekNumber": 33,
      "year": 2025,
      "startDate": "2025-08-12",
      "endDate": "2025-08-18"
    }
    // ... more weeks
  ]
}
```

#### **3. Monthly Summary**
```javascript
// Request
GET /api/orders/statistics/summary?period=month

// Response Structure
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [
    // Nhi·ªÅu records, m·ªói record = 1 th√°ng
    {
      "date": "2025-08-01",           // Ng√†y ƒë·∫ßu th√°ng
      "totalOrders": 1250,
      "completedOrders": 1050,
      "canceledOrders": 150,
      "refundedOrders": 50,
      "netRevenue": 75000000.00,
      "aov": 60000.00,
      "period": "monthly",
      "dateRange": "August 2025",
      "monthNumber": 8,
      "monthName": "Th√°ng T√°m",
      "year": 2025,
      "startDate": "2025-08-01",
      "endDate": "2025-08-31"
    },
    {
      "date": "2025-07-01",
      "totalOrders": 1180,
      "completedOrders": 980,
      "canceledOrders": 140,
      "refundedOrders": 60,
      "netRevenue": 68500000.00,
      "aov": 58050.85,
      "period": "monthly",
      "dateRange": "July 2025",
      "monthNumber": 7,
      "monthName": "Th√°ng B·∫£y",
      "year": 2025,
      "startDate": "2025-07-01",
      "endDate": "2025-07-31"
    }
    // ... more months
  ]
}
```

#### **4. Quarterly Summary**
```javascript
// Request
GET /api/orders/statistics/summary?period=quarter

// Response Structure
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [
    // Nhi·ªÅu records, m·ªói record = 1 qu√Ω
    {
      "date": "2025-07-01",           // Ng√†y ƒë·∫ßu qu√Ω
      "totalOrders": 3850,
      "completedOrders": 3200,
      "canceledOrders": 450,
      "refundedOrders": 200,
      "netRevenue": 225000000.00,
      "aov": 58441.56,
      "period": "quarterly",
      "dateRange": "Qu√Ω 3 nƒÉm 2025",
      "quarter": 3,
      "year": 2025,
      "startDate": "2025-07-01",
      "endDate": "2025-09-30"
    },
    {
      "date": "2025-04-01",
      "totalOrders": 3650,
      "completedOrders": 3050,
      "canceledOrders": 420,
      "refundedOrders": 180,
      "netRevenue": 210000000.00,
      "aov": 57534.25,
      "period": "quarterly",
      "dateRange": "Qu√Ω 2 nƒÉm 2025",
      "quarter": 2,
      "year": 2025,
      "startDate": "2025-04-01",
      "endDate": "2025-06-30"
    }
    // ... more quarters
  ]
}
```

#### **5. Yearly Summary**
```javascript
// Request
GET /api/orders/statistics/summary?period=year

// Response Structure
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [
    // Nhi·ªÅu records, m·ªói record = 1 nƒÉm
    {
      "date": "2025-01-01",           // Ng√†y ƒë·∫ßu nƒÉm
      "totalOrders": 15500,
      "completedOrders": 13200,
      "canceledOrders": 1800,
      "refundedOrders": 500,
      "netRevenue": 950000000.00,
      "aov": 61290.32,
      "period": "yearly",
      "dateRange": "Year 2025",
      "year": 2025,
      "startDate": "2025-01-01",
      "endDate": "2025-12-31"
    },
    {
      "date": "2024-01-01",
      "totalOrders": 14200,
      "completedOrders": 12000,
      "canceledOrders": 1700,
      "refundedOrders": 500,
      "netRevenue": 820000000.00,
      "aov": 57746.48,
      "period": "yearly",
      "dateRange": "Year 2024",
      "year": 2024,
      "startDate": "2024-01-01",
      "endDate": "2024-12-31"
    }
    // ... more years
  ]
}
```

#### **6. Custom Date Range**
```javascript
// Request - L·∫•y 30 ng√†y t·ª´ 1/8/2025 ƒë·∫øn 30/8/2025
const fromDate = new Date('2025-08-01').getTime(); // 1722441600000
const toDate = new Date('2025-08-30').getTime();   // 1724947200000

GET /api/orders/statistics/summary?period=day&fromDate=${fromDate}&toDate=${toDate}

// Response Structure
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [
    // 30 records, m·ªói record = 1 ng√†y trong kho·∫£ng th·ªùi gian
    {
      "date": "2025-08-30",
      "totalOrders": 48,
      "completedOrders": 42,
      "canceledOrders": 4,
      "refundedOrders": 2,
      "netRevenue": 2680000.00,
      "aov": 55833.33,
      "period": "daily",
      "dateRange": "2025-08-30",
      "startDate": "2025-08-30",
      "endDate": "2025-08-30"
    },
    {
      "date": "2025-08-29",
      "totalOrders": 51,
      "completedOrders": 45,
      "canceledOrders": 5,
      "refundedOrders": 1,
      "netRevenue": 2950000.00,
      "aov": 57843.14,
      "period": "daily",
      "dateRange": "2025-08-29",
      "startDate": "2025-08-29",
      "endDate": "2025-08-29"
    }
    // ... 28 records n·ªØa t·ª´ 2025-08-28 xu·ªëng 2025-08-01
  ]
}
```

---

## üîç TIER 2: Order Statistics Details API

### **Endpoint**
```
GET /api/orders/statistics/details
```

### **Parameters**

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `period` | String | ‚úÖ | - | "day", "week", "month", "quarter", "year" |
| `date` | Long | ‚úÖ | - | Timestamp ƒë·∫°i di·ªán cho th·ªùi ƒëi·ªÉm c·∫ßn xem |
| `limit` | Integer | ‚ùå | 10 | S·ªë l∆∞·ª£ng ƒë∆°n h√†ng mu·ªën l·∫•y |

### **üéÆ C√°c tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng**

#### **1. Xem ƒë∆°n h√†ng trong ng√†y c·ª• th·ªÉ**
```javascript
// Scenario: User click v√†o ƒëi·ªÉm ng√†y 25/8/2025 tr√™n chart
const clickDate = new Date('2025-08-25 10:30:00').getTime();

// Request
GET /api/orders/statistics/details?period=day&date=${clickDate}&limit=20

// Response Structure
{
  "status": 200,
  "message": "L·∫•y chi ti·∫øt ƒë∆°n h√†ng th√†nh c√¥ng",
  "data": [
    {
      "orderCode": "ORD-2025082501",
      "customerName": "Nguy·ªÖn VƒÉn A",
      "customerEmail": "nguyenvana@email.com",
      "totalAmount": 550000.00,
      "orderStatus": "DELIVERED",
      "createdAt": 1724572800000,
      "productInfo": "L·∫≠p tr√¨nh Java c∆° b·∫£n (ISBN:978-123456789, ID:15), Spring Boot in Action (ISBN:978-987654321, ID:28)"
    },
    {
      "orderCode": "ORD-2025082502",
      "customerName": "Tr·∫ßn Th·ªã B",
      "customerEmail": "tranthib@email.com",
      "totalAmount": 320000.00,
      "orderStatus": "PROCESSING",
      "createdAt": 1724569200000,
      "productInfo": "Clean Code (ISBN:978-111222333, ID:42)"
    }
    // ... 18 orders n·ªØa
  ]
}
```

#### **2. Xem ƒë∆°n h√†ng trong tu·∫ßn**
```javascript
// Scenario: User click v√†o ƒëi·ªÉm tu·∫ßn 34 nƒÉm 2025 tr√™n chart
const weekTimestamp = new Date('2025-08-22').getTime();

// Request  
GET /api/orders/statistics/details?period=week&date=${weekTimestamp}&limit=15

// Response Structure
{
  "status": 200,
  "message": "L·∫•y chi ti·∫øt ƒë∆°n h√†ng th√†nh c√¥ng",
  "data": [
    // 15 ƒë∆°n h√†ng t·ª´ th·ª© 2 (19/8) ƒë·∫øn ch·ªß nh·∫≠t (25/8)
    {
      "orderCode": "ORD-2025081901",
      "customerName": "L√™ Minh C",
      "customerEmail": "leminhc@email.com",
      "totalAmount": 750000.00,
      "orderStatus": "DELIVERED",
      "createdAt": 1724054400000,
      "productInfo": "Design Patterns (ISBN:978-555666777, ID:67), The Pragmatic Programmer (ISBN:978-888999000, ID:89)"
    }
    // ... 14 orders n·ªØa trong tu·∫ßn
  ]
}
```

#### **3. Xem ƒë∆°n h√†ng trong th√°ng**
```javascript
// Scenario: User click v√†o ƒëi·ªÉm th√°ng 8/2025 tr√™n chart
const monthTimestamp = new Date('2025-08-15').getTime();

// Request
GET /api/orders/statistics/details?period=month&date=${monthTimestamp}&limit=50

// Response Structure
{
  "status": 200,
  "message": "L·∫•y chi ti·∫øt ƒë∆°n h√†ng th√†nh c√¥ng",
  "data": [
    // 50 ƒë∆°n h√†ng trong th√°ng 8/2025
    {
      "orderCode": "ORD-2025080101",
      "customerName": "Ph·∫°m Thu D",
      "customerEmail": "phamthud@email.com",
      "totalAmount": 1200000.00,
      "orderStatus": "DELIVERED",
      "createdAt": 1722441600000,
      "productInfo": "Effective Java (ISBN:978-123123123, ID:101), Spring Security (ISBN:978-456456456, ID:102), Database Design (ISBN:978-789789789, ID:103)"
    }
    // ... 49 orders n·ªØa trong th√°ng
  ]
}
```

#### **4. Xem ƒë∆°n h√†ng trong qu√Ω**
```javascript
// Scenario: User click v√†o ƒëi·ªÉm qu√Ω 3/2025 tr√™n chart  
const quarterTimestamp = new Date('2025-08-01').getTime();

// Request
GET /api/orders/statistics/details?period=quarter&date=${quarterTimestamp}&limit=100

// Response Structure
{
  "status": 200,
  "message": "L·∫•y chi ti·∫øt ƒë∆°n h√†ng th√†nh c√¥ng",
  "data": [
    // 100 ƒë∆°n h√†ng trong qu√Ω 3 (7-9/2025)
    {
      "orderCode": "ORD-2025070101",
      "customerName": "V√µ VƒÉn E",
      "customerEmail": "vovane@email.com",
      "totalAmount": 950000.00,
      "orderStatus": "DELIVERED",
      "createdAt": 1719763200000,
      "productInfo": "Microservices Patterns (ISBN:978-321321321, ID:201), Docker Deep Dive (ISBN:978-654654654, ID:202)"
    }
    // ... 99 orders n·ªØa trong qu√Ω
  ]
}
```

#### **5. Xem ƒë∆°n h√†ng trong nƒÉm**
```javascript
// Scenario: User click v√†o ƒëi·ªÉm nƒÉm 2025 tr√™n chart
const yearTimestamp = new Date('2025-06-01').getTime();

// Request
GET /api/orders/statistics/details?period=year&date=${yearTimestamp}&limit=200

// Response Structure
{
  "status": 200,
  "message": "L·∫•y chi ti·∫øt ƒë∆°n h√†ng th√†nh c√¥ng",
  "data": [
    // 200 ƒë∆°n h√†ng trong nƒÉm 2025
    {
      "orderCode": "ORD-2025010101",
      "customerName": "Ho√†ng Th·ªã F",
      "customerEmail": "hoangthif@email.com",
      "totalAmount": 1500000.00,
      "orderStatus": "DELIVERED",
      "createdAt": 1704067200000,
      "productInfo": "System Design Interview (ISBN:978-111111111, ID:301), Kubernetes in Action (ISBN:978-222222222, ID:302), DevOps Handbook (ISBN:978-333333333, ID:303)"
    }
    // ... 199 orders n·ªØa trong nƒÉm
  ]
}
```

---

## üî• COMPLETE Response Field Mapping

### **Summary API Response Fields**

| Field | Type | Description | Example |
|-------|------|-------------|---------|
| `date` | String | Ng√†y ƒë·∫°i di·ªán (YYYY-MM-DD) | "2025-08-25" |
| `totalOrders` | Integer | T·ªïng s·ªë ƒë∆°n h√†ng trong period | 45 |
| `completedOrders` | Integer | S·ªë ƒë∆°n ƒë√£ giao (DELIVERED) | 38 |
| `canceledOrders` | Integer | S·ªë ƒë∆°n ƒë√£ h·ªßy (CANCELED) | 5 |
| `refundedOrders` | Integer | S·ªë ƒë∆°n ho√†n tr·∫£ (PARTIALLY_REFUNDED + REFUNDED) | 2 |
| `netRevenue` | Double | Doanh thu thu·∫ßn (VND) | 2450000.00 |
| `aov` | Double | Average Order Value (netRevenue/totalOrders) | 54444.44 |
| `period` | String | Lo·∫°i period ("daily", "weekly", "monthly", etc.) | "daily" |
| `dateRange` | String | M√¥ t·∫£ kho·∫£ng th·ªùi gian | "2025-08-25" |
| `startDate` | String | Ng√†y b·∫Øt ƒë·∫ßu period | "2025-08-25" |
| `endDate` | String | Ng√†y k·∫øt th√∫c period | "2025-08-25" |
| **Weekly-specific fields** |||
| `weekNumber` | Integer | S·ªë tu·∫ßn trong nƒÉm | 34 |
| `year` | Integer | NƒÉm | 2025 |
| **Monthly-specific fields** |||
| `monthNumber` | Integer | S·ªë th√°ng (1-12) | 8 |
| `monthName` | String | T√™n th√°ng ti·∫øng Vi·ªát | "Th√°ng T√°m" |
| **Quarterly-specific fields** |||
| `quarter` | Integer | Qu√Ω (1-4) | 3 |

### **Details API Response Fields**

| Field | Type | Description | Example |
|-------|------|-------------|---------|
| `orderCode` | String | M√£ ƒë∆°n h√†ng | "ORD-2025082501" |
| `customerName` | String | T√™n kh√°ch h√†ng | "Nguy·ªÖn VƒÉn A" |
| `customerEmail` | String | Email kh√°ch h√†ng | "nguyenvana@email.com" |
| `totalAmount` | Double | T·ªïng gi√° tr·ªã ƒë∆°n h√†ng (VND) | 550000.00 |
| `orderStatus` | String | Tr·∫°ng th√°i ƒë∆°n h√†ng | "DELIVERED" |
| `createdAt` | Long | Timestamp t·∫°o ƒë∆°n (milliseconds) | 1724572800000 |
| `productInfo` | String | Danh s√°ch s·∫£n ph·∫©m (Title, ISBN, ID) | "L·∫≠p tr√¨nh Java c∆° b·∫£n (ISBN:978-123456789, ID:15)" |

---

## üö® Error Handling & Status Codes

### **Success Response**
```json
{
  "status": 200,
  "message": "L·∫•y th·ªëng k√™ t·ªïng quan th√†nh c√¥ng",
  "data": [...] // Array of data
}
```

### **Invalid Period**
```json
{
  "status": 400,
  "message": "Period kh√¥ng h·ª£p l·ªá. Ch·ªâ ch·∫•p nh·∫≠n: day, week, month, quarter, year",
  "data": []
}
```

### **Missing Required Parameters (Details API)**
```json
{
  "status": 400,
  "message": "Tham s·ªë 'date' l√† b·∫Øt bu·ªôc cho API chi ti·∫øt",
  "data": []
}
```

### **Invalid Date Range - Period Duration Limits**

#### **üî• Daily Period Validation**
```json
// Request: Kho·∫£ng th·ªùi gian < 1 ng√†y
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° nh·ªè cho ch·∫ø ƒë·ªô ng√†y (t·ªëi thi·ªÉu 1 ng√†y). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 0 ng√†y.",
  "data": []
}

// Request: Kho·∫£ng th·ªùi gian > 90 ng√†y  
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° l·ªõn cho ch·∫ø ƒë·ªô ng√†y (t·ªëi ƒëa 90 ng√†y). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 120 ng√†y.",
  "data": []
}
```

#### **üî• Weekly Period Validation**
```json
// Request: Kho·∫£ng th·ªùi gian < 7 ng√†y
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° nh·ªè cho ch·∫ø ƒë·ªô tu·∫ßn (t·ªëi thi·ªÉu 7 ng√†y). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 5 ng√†y.",
  "data": []
}

// Request: Kho·∫£ng th·ªùi gian > 2 nƒÉm
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° l·ªõn cho ch·∫ø ƒë·ªô tu·∫ßn (t·ªëi ƒëa 2 nƒÉm). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 3 nƒÉm.",
  "data": []
}
```

#### **üî• Monthly Period Validation**
```json
// Request: Kho·∫£ng th·ªùi gian < 28 ng√†y
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° nh·ªè cho ch·∫ø ƒë·ªô th√°ng (t·ªëi thi·ªÉu 28 ng√†y). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 20 ng√†y.",
  "data": []
}

// Request: Kho·∫£ng th·ªùi gian > 5 nƒÉm
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° l·ªõn cho ch·∫ø ƒë·ªô th√°ng (t·ªëi ƒëa 5 nƒÉm). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 7 nƒÉm.",
  "data": []
}
```

#### **üî• Quarterly Period Validation**
```json
// Request: Kho·∫£ng th·ªùi gian < 90 ng√†y
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° nh·ªè cho ch·∫ø ƒë·ªô qu√Ω (t·ªëi thi·ªÉu 90 ng√†y). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 60 ng√†y.",
  "data": []
}

// Request: Kho·∫£ng th·ªùi gian > 5 nƒÉm
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° l·ªõn cho ch·∫ø ƒë·ªô qu√Ω (t·ªëi ƒëa 5 nƒÉm). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 8 nƒÉm.",
  "data": []
}
```

#### **üî• Yearly Period Validation**
```json
// Request: Kho·∫£ng th·ªùi gian < 365 ng√†y
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° nh·ªè cho ch·∫ø ƒë·ªô nƒÉm (t·ªëi thi·ªÉu 365 ng√†y). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 200 ng√†y.",
  "data": []
}

// Request: Kho·∫£ng th·ªùi gian > 25 nƒÉm
{
  "status": 400,
  "message": "Kho·∫£ng th·ªùi gian qu√° l·ªõn cho ch·∫ø ƒë·ªô nƒÉm (t·ªëi ƒëa 25 nƒÉm). Kho·∫£ng th·ªùi gian hi·ªán t·∫°i: 30 nƒÉm.",
  "data": []
}
```

### **üìä Period Duration Limits Summary**

| Period Type | Minimum Duration | Maximum Duration | Example Valid Range |
|-------------|------------------|------------------|-------------------|
| **Daily** | 1 ng√†y | 90 ng√†y | 1-90 ng√†y |
| **Weekly** | 7 ng√†y (1 tu·∫ßn) | 2 nƒÉm (730 ng√†y) | 1 tu·∫ßn - 2 nƒÉm |
| **Monthly** | 28 ng√†y (1 th√°ng) | 5 nƒÉm (1825 ng√†y) | 1 th√°ng - 5 nƒÉm |
| **Quarterly** | 90 ng√†y (1 qu√Ω) | 5 nƒÉm (1825 ng√†y) | 1 qu√Ω - 5 nƒÉm |
| **Yearly** | 365 ng√†y (1 nƒÉm) | 25 nƒÉm (9125 ng√†y) | 1 nƒÉm - 25 nƒÉm |

### **üéØ Incomplete Period Handling**

**Quan tr·ªçng**: Khi kho·∫£ng th·ªùi gian kh√¥ng ƒë·ªß 1 ƒë∆°n v·ªã period (v√≠ d·ª•: ch·ªçn weekly nh∆∞ng ch·ªâ c√≥ 5 ng√†y), h·ªá th·ªëng v·∫´n ch·∫•p nh·∫≠n n·∫øu ƒë·∫°t minimum requirements, nh∆∞ng `endDate` trong response s·∫Ω ph·∫£n √°nh ƒë√∫ng kho·∫£ng th·ªùi gian th·ª±c t·∫ø.

#### **V√≠ d·ª• Weekly v·ªõi kho·∫£ng th·ªùi gian thi·∫øu:**
```javascript
// Request: period=week v·ªõi 10 ng√†y (thay v√¨ 14 ng√†y = 2 tu·∫ßn ƒë·∫ßy ƒë·ªß)
const fromDate = new Date('2025-08-20').getTime(); // Th·ª© 3
const toDate = new Date('2025-08-29').getTime();   // Th·ª© 5 tu·∫ßn sau

GET /api/orders/statistics/summary?period=week&fromDate=${fromDate}&toDate=${toDate}

// Response: Ch·ªâ 1 week record, endDate ch·ªâ ƒë·∫øn 2025-08-29
{
  "status": 200,
  "data": [
    {
      "date": "2025-08-18",           // Monday c·ªßa tu·∫ßn ch·ª©a startDate
      "totalOrders": 85,
      "period": "weekly",
      "dateRange": "2025-08-18 to 2025-08-29",
      "weekNumber": 34,
      "year": 2025,
      "startDate": "2025-08-18",
      "endDate": "2025-08-29"        // ‚ö†Ô∏è Ch·ªâ ƒë·∫øn ng√†y 29, kh√¥ng ph·∫£i 24 (Sunday)
    }
  ]
}
```

#### **V√≠ d·ª• Monthly v·ªõi th√°ng kh√¥ng ƒë·∫ßy ƒë·ªß:**
```javascript
// Request: period=month v·ªõi 15 ng√†y trong th√°ng 8
const fromDate = new Date('2025-08-10').getTime();
const toDate = new Date('2025-08-25').getTime();

// Response: endDate = 2025-08-25 thay v√¨ 2025-08-31
{
  "status": 200,
  "data": [
    {
      "date": "2025-08-01",
      "period": "monthly",
      "dateRange": "August 2025",
      "startDate": "2025-08-01",
      "endDate": "2025-08-25"        // ‚ö†Ô∏è Ph·∫£n √°nh ƒë√∫ng range th·ª±c t·∫ø
    }
  ]
}
```

### **No Data Available**
```json
{
  "status": 200,
  "message": "Kh√¥ng c√≥ d·ªØ li·ªáu trong kho·∫£ng th·ªùi gian n√†y",
  "data": []
}
```

### **Server Error**
```json
{
  "status": 500,
  "message": "L·ªói server khi x·ª≠ l√Ω th·ªëng k√™",
  "data": []
}
```

---

## üí° Frontend Integration Tips

### **1. Period Validation Before API Call**
```javascript
// Validation helper function - FE n√™n validate tr∆∞·ªõc khi call API
function validatePeriodDateRange(period, fromDate, toDate) {
  const durationMs = toDate - fromDate;
  const durationDays = Math.floor(durationMs / (24 * 60 * 60 * 1000));
  const durationYears = Math.floor(durationDays / 365);
  
  const limits = {
    daily: { min: 1, max: 90, unit: 'ng√†y' },
    weekly: { min: 7, max: 730, unit: 'ng√†y' }, // 2 nƒÉm
    monthly: { min: 28, max: 1825, unit: 'ng√†y' }, // 5 nƒÉm  
    quarterly: { min: 90, max: 1825, unit: 'ng√†y' }, // 5 nƒÉm
    yearly: { min: 365, max: 9125, unit: 'ng√†y' } // 25 nƒÉm
  };
  
  const limit = limits[period.toLowerCase()];
  if (!limit) return { valid: false, message: "Period kh√¥ng h·ª£p l·ªá" };
  
  if (durationDays < limit.min) {
    return { 
      valid: false, 
      message: `Kho·∫£ng th·ªùi gian qu√° nh·ªè cho ch·∫ø ƒë·ªô ${period} (t·ªëi thi·ªÉu ${limit.min} ${limit.unit}). Hi·ªán t·∫°i: ${durationDays} ng√†y.`
    };
  }
  
  if (durationDays > limit.max) {
    return { 
      valid: false, 
      message: `Kho·∫£ng th·ªùi gian qu√° l·ªõn cho ch·∫ø ƒë·ªô ${period} (t·ªëi ƒëa ${limit.max} ${limit.unit}). Hi·ªán t·∫°i: ${durationDays} ng√†y.`
    };
  }
  
  return { valid: true, message: "Valid" };
}

// Usage example trong date picker component
function handleDateRangeChange(startDate, endDate, selectedPeriod) {
  const validation = validatePeriodDateRange(selectedPeriod, startDate.getTime(), endDate.getTime());
  
  if (!validation.valid) {
    // Hi·ªÉn th·ªã error message cho user
    showErrorMessage(validation.message);
    return false;
  }
  
  // Proceed v·ªõi API call
  fetchOrderStatistics(selectedPeriod, startDate.getTime(), endDate.getTime());
  return true;
}
```

### **2. Chart Integration Example**
```javascript
// Fetch data cho chart
async function fetchOrderStatistics(period = 'day', fromDate = null, toDate = null) {
  try {
    let url = `/api/orders/statistics/summary?period=${period}`;
    if (fromDate && toDate) {
      url += `&fromDate=${fromDate}&toDate=${toDate}`;
    }
    
    const response = await fetch(url);
    const result = await response.json();
    
    if (result.status === 200) {
      // Transform data for chart
      const chartData = result.data.map(item => ({
        x: item.date,
        totalOrders: item.totalOrders,
        completedOrders: item.completedOrders,
        canceledOrders: item.canceledOrders,
        refundedOrders: item.refundedOrders,
        netRevenue: item.netRevenue,
        aov: item.aov,
        dateRange: item.dateRange,
        period: item.period,
        // Actual range info for incomplete periods
        startDate: item.startDate,
        endDate: item.endDate
      }));
      
      return chartData;
    } else {
      // Handle validation errors
      showErrorMessage(result.message);
      return [];
    }
  } catch (error) {
    console.error('Error fetching order statistics:', error);
    showErrorMessage('L·ªói k·∫øt n·ªëi API');
    return [];
  }
}

// Handle chart point click
function onChartPointClick(dataPoint, period) {
  const clickedDate = new Date(dataPoint.x).getTime();
  fetchOrderDetails(period, clickedDate, 20);
}

// Fetch details khi click v√†o chart
async function fetchOrderDetails(period, date, limit = 10) {
  try {
    const response = await fetch(`/api/orders/statistics/details?period=${period}&date=${date}&limit=${limit}`);
    const result = await response.json();
    
    if (result.status === 200) {
      return result.data;
    } else {
      showErrorMessage(result.message);
      return [];
    }
  } catch (error) {
    console.error('Error fetching order details:', error);
    showErrorMessage('L·ªói k·∫øt n·ªëi API');
    return [];
  }
}
```

### **3. Period Selector Component**
```javascript
const periodOptions = [
  { 
    value: 'day', 
    label: 'Theo ng√†y', 
    description: '7 ng√†y g·∫ßn nh·∫•t (t·ªëi ƒëa 90 ng√†y)',
    chartType: 'line',
    limits: { min: 1, max: 90 }
  },
  { 
    value: 'week', 
    label: 'Theo tu·∫ßn', 
    description: 'C√°c tu·∫ßn g·∫ßn ƒë√¢y (t·ªëi ƒëa 2 nƒÉm)',
    chartType: 'bar',
    limits: { min: 7, max: 730 }
  },
  { 
    value: 'month', 
    label: 'Theo th√°ng', 
    description: 'C√°c th√°ng g·∫ßn ƒë√¢y (t·ªëi ƒëa 5 nƒÉm)',
    chartType: 'bar',
    limits: { min: 28, max: 1825 }
  },
  { 
    value: 'quarter', 
    label: 'Theo qu√Ω', 
    description: 'C√°c qu√Ω g·∫ßn ƒë√¢y (t·ªëi ƒëa 5 nƒÉm)',
    chartType: 'bar',
    limits: { min: 90, max: 1825 }
  },
  { 
    value: 'year', 
    label: 'Theo nƒÉm', 
    description: 'C√°c nƒÉm g·∫ßn ƒë√¢y (t·ªëi ƒëa 25 nƒÉm)',
    chartType: 'bar',
    limits: { min: 365, max: 9125 }
  }
];
```

### **4. Custom Date Range with Validation**
```javascript
// Custom date range picker v·ªõi validation
function handleCustomDateRange(startDate, endDate, selectedPeriod) {
  const fromDate = startDate.getTime();
  const toDate = endDate.getTime();
  
  // Validation tr∆∞·ªõc khi g·ªçi API
  const validation = validatePeriodDateRange(selectedPeriod, fromDate, toDate);
  if (!validation.valid) {
    alert(validation.message);
    return false;
  }
  
  // Call API v·ªõi custom range
  fetchOrderStatistics(selectedPeriod, fromDate, toDate)
    .then(data => {
      if (data.length > 0) {
        updateChart(data);
        
        // Show actual date range ƒë∆∞·ª£c s·ª≠ d·ª•ng
        const actualStartDate = data[0].startDate;
        const actualEndDate = data[data.length - 1].endDate;
        showDateRangeInfo(`Hi·ªÉn th·ªã d·ªØ li·ªáu t·ª´ ${actualStartDate} ƒë·∫øn ${actualEndDate}`);
      } else {
        showNoDataMessage();
      }
    });
    
  return true;
}
```

### **5. Data Formatting Helpers**
```javascript
// Format currency
function formatCurrency(amount) {
  return new Intl.NumberFormat('vi-VN', {
    style: 'currency',
    currency: 'VND'
  }).format(amount);
}

// Format date based on period
function formatDateLabel(dateStr, period) {
  const date = new Date(dateStr);
  
  switch (period) {
    case 'daily':
      return date.toLocaleDateString('vi-VN');
    case 'weekly':
      return `Tu·∫ßn ${getWeekNumber(date)}`;
    case 'monthly':
      return date.toLocaleDateString('vi-VN', { year: 'numeric', month: 'long' });
    case 'quarterly':
      return `Qu√Ω ${Math.ceil((date.getMonth() + 1) / 3)} - ${date.getFullYear()}`;
    case 'yearly':
      return date.getFullYear().toString();
    default:
      return dateStr;
  }
}

// Convert timestamp to readable date
function formatTimestamp(timestamp) {
  return new Date(timestamp).toLocaleDateString('vi-VN', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit'
  });
}

// Get week number helper
function getWeekNumber(date) {
  const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
  const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
  return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
}

// Format order status for display
function formatOrderStatus(status) {
  const statusMap = {
    'PENDING': 'Ch·ªù x√°c nh·∫≠n',
    'CONFIRMED': 'ƒê√£ x√°c nh·∫≠n', 
    'PROCESSING': 'ƒêang x·ª≠ l√Ω',
    'SHIPPED': 'ƒê√£ g·ª≠i h√†ng',
    'DELIVERED': 'ƒê√£ giao h√†ng',
    'CANCELED': 'ƒê√£ h·ªßy',
    'PARTIALLY_REFUNDED': 'Ho√†n tr·∫£ m·ªôt ph·∫ßn',
    'REFUNDED': 'Ho√†n tr·∫£ to√†n b·ªô'
  };
  return statusMap[status] || status;
}

// Validate and show range info for incomplete periods
function showActualRangeInfo(data, requestedPeriod) {
  if (data.length === 0) return;
  
  const firstItem = data[0];
  const lastItem = data[data.length - 1];
  
  const actualStart = firstItem.startDate;
  const actualEnd = lastItem.endDate;
  
  // Check if this is an incomplete period
  const expectedEnd = getExpectedPeriodEnd(firstItem.startDate, requestedPeriod);
  
  if (actualEnd !== expectedEnd) {
    showWarningMessage(
      `‚ö†Ô∏è D·ªØ li·ªáu hi·ªÉn th·ªã t·ª´ ${actualStart} ƒë·∫øn ${actualEnd} (kho·∫£ng th·ªùi gian kh√¥ng ƒë·ªß 1 ${requestedPeriod} ho√†n ch·ªânh)`
    );
  }
}
```
```

---

## üîó Order Status Reference

| Status | Description | Trong Summary | FE Display |
|--------|-------------|---------------|------------|
| `PENDING` | Ch·ªù x√°c nh·∫≠n | totalOrders | "Ch·ªù x√°c nh·∫≠n" |
| `CONFIRMED` | ƒê√£ x√°c nh·∫≠n | totalOrders | "ƒê√£ x√°c nh·∫≠n" |
| `PROCESSING` | ƒêang x·ª≠ l√Ω | totalOrders | "ƒêang x·ª≠ l√Ω" |
| `SHIPPED` | ƒê√£ g·ª≠i h√†ng | totalOrders | "ƒê√£ g·ª≠i h√†ng" |
| `DELIVERED` | ƒê√£ giao h√†ng | **completedOrders** | "ƒê√£ giao h√†ng" |
| `CANCELED` | ƒê√£ h·ªßy | **canceledOrders** | "ƒê√£ h·ªßy" |
| `PARTIALLY_REFUNDED` | Ho√†n tr·∫£ m·ªôt ph·∫ßn | **refundedOrders** | "Ho√†n tr·∫£ m·ªôt ph·∫ßn" |
| `REFUNDED` | Ho√†n tr·∫£ to√†n b·ªô | **refundedOrders** | "Ho√†n tr·∫£ to√†n b·ªô" |

---

## üéØ Data Validation Checklist

‚úÖ **Summary API Response c√≥ ƒë·∫ßy ƒë·ªß:**
- `date`, `totalOrders`, `completedOrders`, `canceledOrders`, `refundedOrders`
- `netRevenue`, `aov`, `period`, `dateRange`, `startDate`, `endDate`
- Period-specific fields: `weekNumber`, `year`, `monthNumber`, `monthName`, `quarter`

‚úÖ **Details API Response c√≥ ƒë·∫ßy ƒë·ªß:**
- `orderCode`, `customerName`, `customerEmail`
- `totalAmount`, `orderStatus`, `createdAt`, `productInfo`

‚úÖ **Error Handling Cover:**
- Invalid period, missing required params, invalid date range
- No data available, server errors

‚úÖ **Frontend Integration Ready:**
- Chart data mapping, period selectors, date formatters
- Custom date range handling, status reference mapping

---

**üöÄ Ready for Production Integration!**
